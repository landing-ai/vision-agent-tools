from vision_agent_tools.models.utils import filter_redundant_boxes


def test_filter_redundant_boxes():
    input_data = {
        "bboxes": [
            [1.5, 253.50001525878906, 546.300048828125, 599.1000366210938],
            [
                240.3000030517578,
                554.1000366210938,
                254.70001220703125,
                599.1000366210938,
            ],
            [526.5, 367.5, 542.7000122070312, 402.3000183105469],
            [
                311.1000061035156,
                453.9000244140625,
                327.3000183105469,
                483.9000244140625,
            ],
            [
                192.90000915527344,
                329.1000061035156,
                212.10000610351562,
                353.70001220703125,
            ],
            [
                351.3000183105469,
                428.70001220703125,
                365.1000061035156,
                461.70001220703125,
            ],
            [312.3000183105469, 552.300048828125, 330.3000183105469, 576.9000244140625],
            [0.30000001192092896, 256.5, 15.300000190734863, 282.3000183105469],
            [
                228.90000915527344,
                440.1000061035156,
                242.70001220703125,
                471.3000183105469,
            ],
            [
                128.10000610351562,
                383.1000061035156,
                140.10000610351562,
                417.9000244140625,
            ],
            [
                62.10000228881836,
                366.9000244140625,
                75.9000015258789,
                395.70001220703125,
            ],
            [
                251.70001220703125,
                359.1000061035156,
                263.1000061035156,
                392.1000061035156,
            ],
            [35.10000228881836, 307.5, 52.500003814697266, 328.5],
            [
                155.10000610351562,
                452.70001220703125,
                167.70001220703125,
                479.70001220703125,
            ],
            [
                204.3000030517578,
                279.9000244140625,
                223.50001525878906,
                296.1000061035156,
            ],
        ],
        "labels": [
            "sheep",
            "sheep",
            "sheep",
            "sheep",
            "sheep",
            "sheep",
            "sheep",
            "sheep",
            "sheep",
            "sheep",
            "sheep",
            "sheep",
            "sheep",
            "sheep",
            "sheep",
        ],
    }

    filtered_data = filter_redundant_boxes(input_data)

    assert len(filtered_data["bboxes"]) == 14
    assert len(filtered_data["labels"]) == 14
